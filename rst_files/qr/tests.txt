=====================================
A set of unit tests for qrefine
=====================================

.. contents::

Overview
--------

A set of unit tests.

Running the program
-------------------

``qr.test`` can be executed on a PDB model file but the primary use if from
the clustering code. The two main functions are

  - cap the cluster with hydrogens to provide a neutral buffer layer and better
    SCF convergence
  - to determine the charge for each cluster


List of all currently implemented tests
---------------------------------------

+------------+----------------------------------------------------------------------------+---------+
| Test ID    | Test summary                                                               |Time (s) |
+============+============================================================================+=========+
| tst_1      | Exercise standard (cctbx-based restraints) refinement with all defaults.   |     7   |
+------------+----------------------------------------------------------------------------+---------+
| tst_2      | Exercise standard (cctbx-based restraints) optimization.                   |    19   |
+------------+----------------------------------------------------------------------------+---------+
| tst_3      | Exercise refine_sites=False.                                               |     4   |
+------------+----------------------------------------------------------------------------+---------+
| tst_4      | Not yet written                                                            |     -   |
+------------+----------------------------------------------------------------------------+---------+
| tst_5      | Exercise max_atoms.                                                        |     4   |
+------------+----------------------------------------------------------------------------+---------+
| tst_6      | Exercise altlocs. (NO ASSERT)                                              |     6   |
+------------+----------------------------------------------------------------------------+---------+
| tst_7      | Exercise interaction graph construction.                                   |     6   |
+------------+----------------------------------------------------------------------------+---------+
| tst_8      | Exercise interaction graph clustering.                                     |     5   |
+------------+----------------------------------------------------------------------------+---------+
| tst_9      | Exercise buffer region of cluster.                                         |     0   |
+------------+----------------------------------------------------------------------------+---------+
| tst_10     | Exercise combined energy and gradients from cluster qm.                    |    10   |
+------------+----------------------------------------------------------------------------+---------+
| tst_11     | Exercise structure completion by finalise.py                               | Skipped |
+------------+----------------------------------------------------------------------------+---------+
| tst_12     | Exercise structure preparation including charge, capping, completion       |    29   |
+------------+----------------------------------------------------------------------------+---------+
| tst_13     | Compare gradients from entire qm and clustered qm.                         | Skipped |
+------------+----------------------------------------------------------------------------+---------+
| tst_14     | Exercise supercell.                                                        |    0    |
+------------+----------------------------------------------------------------------------+---------+
| tst_15     | Exercise gradients match: small vs large box clustering vs not clustering. |   410   |
+------------+----------------------------------------------------------------------------+---------+
| tst_16     | Exercise gradients match: Non-P1 case (P212121)                            |    24   |
+------------+----------------------------------------------------------------------------+---------+
| tst_17     | Exercise altlocs                                                           |    1    |
+------------+----------------------------------------------------------------------------+---------+
| tst_18     | Exercise gradients match: pdbs with altlocs                                |   174   |
+------------+----------------------------------------------------------------------------+---------+
| tst_19     | Exercise altlocs using subtract vs using average                           |   273   |
+------------+----------------------------------------------------------------------------+---------+
| tst_20     | Make sure expand works for this particular file.                           |    18   |
+------------+----------------------------------------------------------------------------+---------+
| tst_21     | Exercise charges are calculated correctly                                  |     ?   |
+------------+----------------------------------------------------------------------------+---------+
| tst_22     | Exercise charges are calculated correctly on pdb                           |     5   |
+------------+----------------------------------------------------------------------------+---------+
| tst_23     | Exercise charges are calculated correctly                                  |     5   |
+------------+----------------------------------------------------------------------------+---------+
| tst_24     | Exercise finalise and charges both work                                    |     8   |
+------------+----------------------------------------------------------------------------+---------+
| tst_25     | Exercise finalise and charges both work                                    |     7   |
+------------+----------------------------------------------------------------------------+---------+
| tst_26     | Exercise charges  are calculated correctly                                 |     3   |
+------------+----------------------------------------------------------------------------+---------+
| tst_27     | Exercise finalise and charges both work                                    |    11   |
+------------+----------------------------------------------------------------------------+---------+
| tst_28     | Exercise finalise and charges both work                                    |     8   |
+------------+----------------------------------------------------------------------------+---------+
| tst_29     | Exercise charges are calculated correctly                                  |     3   |
+------------+----------------------------------------------------------------------------+---------+
| tst_30     | Exercise standard (cctbx-based restraints) optimization (no data required) |    38   |
+------------+----------------------------------------------------------------------------+---------+
| tst_31     | Exercise TorchANI calculator works as expected                             |     0   |
+------------+----------------------------------------------------------------------------+---------+
| tst_32     | Exercise TorchANI calculator raising an error with non supported atoms     |     0   |
+------------+----------------------------------------------------------------------------+---------+
| tst_33     | Exercise PySCF can compute an Energy and Gradient for a given systemÂ       |     0   |
+------------+----------------------------------------------------------------------------+---------+
